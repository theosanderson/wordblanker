<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Word Blanker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .word-tooltip {
      opacity: 0;
      transition: opacity 0.2s;
    }
    .group:hover .word-tooltip {
      opacity: 1;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 p-8">
  <div class="max-w-3xl mx-auto">
    <h1 class="text-4xl font-bold text-center mb-2 text-indigo-900">
      Word Blanker
    </h1>
    <p class="text-center text-gray-600 mb-8">
      Enter text, then click any word to replace it with BLANK
    </p>

    <!-- Input Section -->
    <div id="inputSection" class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
      <textarea
        id="inputText"
        placeholder="Enter your text here..."
        class="w-full h-48 p-4 border-2 border-gray-200 rounded-xl focus:border-indigo-400 focus:outline-none resize-none text-lg transition-colors"
      ></textarea>
      <button
        id="convertBtn"
        onclick="convertText()"
        class="mt-4 w-full py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
      >
        Convert to Clickable Words
      </button>
    </div>

    <!-- Editor Section -->
    <div id="editorSection" class="space-y-6 hidden">
      <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
        <p class="text-sm text-gray-500 mb-3">Click words to blank them. Hover over blanks to reveal. Click on a word again to unblank it, and scroll down to see final results.</p>
        <div id="wordsContainer" class="flex flex-wrap leading-relaxed text-xl"></div>
      </div>

      <div class="flex gap-3 flex-wrap">
        <button
          onclick="resetAll()"
          class="flex-1 py-3 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-colors"
        >
          Reset All
        </button>
        <button
          onclick="blankAll()"
          class="flex-1 py-3 bg-purple-100 text-purple-700 font-semibold rounded-xl hover:bg-purple-200 transition-colors"
        >
          Blank All
        </button>
        <button
          onclick="startOver()"
          class="flex-1 py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition-colors"
        >
          Start Over
        </button>
      </div>

      <div class="grid gap-4 md:grid-cols-2">
        <div class="bg-gray-50 rounded-xl p-4 border border-gray-200">
          <h3 class="font-semibold text-gray-700 mb-2">Original Text:</h3>
          <p id="originalText" class="text-gray-600 whitespace-pre-wrap"></p>
        </div>
        <div class="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
          <h3 class="font-semibold text-indigo-700 mb-2">Prompt:</h3>
          <p id="promptText" class="text-indigo-900 whitespace-pre-wrap"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    let words = [];

    function convertText() {
      const inputText = document.getElementById('inputText').value;
      if (!inputText.trim()) return;

      const tokens = inputText.split(/(\s+)/);
      words = tokens.map((token, index) => {
        const isSpace = /^\s+$/.test(token);
        const match = token.match(/^([^\w]*)(\w+)([^\w]*)$/);

        let suffix = '';
        let wordBase = match ? match[2] : token;

        if (match) {
          if (wordBase.toLowerCase().endsWith('ing') && wordBase.length > 3) {
            suffix = wordBase.slice(-3);
            wordBase = wordBase.slice(0, -3);
          } else if (wordBase.toLowerCase().endsWith('ed') && wordBase.length > 2) {
            suffix = wordBase.slice(-2);
            wordBase = wordBase.slice(0, -2);
          } else if (wordBase.endsWith("'s") && wordBase.length > 2) {
            suffix = wordBase.slice(-2);
            wordBase = wordBase.slice(0, -2);
          } else if (wordBase.toLowerCase().endsWith('s') && wordBase.length > 1) {
            suffix = wordBase.slice(-1);
            wordBase = wordBase.slice(0, -1);
          }
        }

        return {
          id: index,
          original: token,
          leadingPunct: match ? match[1] : '',
          word: match ? match[2] : token,
          wordBase: wordBase,
          suffix: suffix,
          trailingPunct: match ? match[3] : '',
          isBlanked: false,
          isSpace: isSpace,
          isWord: match !== null
        };
      });

      document.getElementById('inputSection').classList.add('hidden');
      document.getElementById('editorSection').classList.remove('hidden');
      renderWords();
      updateResults();
    }

    function renderWords() {
      const container = document.getElementById('wordsContainer');
      container.innerHTML = '';

      words.forEach(word => {
        if (word.isSpace) {
          const span = document.createElement('span');
          span.textContent = word.original;
          container.appendChild(span);
        } else if (word.isWord) {
          const wrapper = document.createElement('span');
          wrapper.className = 'cursor-pointer relative group';
          wrapper.onclick = () => toggleBlank(word.id);

          const leading = document.createElement('span');
          leading.className = 'text-gray-400';
          leading.textContent = word.leadingPunct;

          const wordSpan = document.createElement('span');
          wordSpan.className = `px-1 py-0.5 rounded transition-all duration-200 ${
            word.isBlanked
              ? 'bg-indigo-600 text-white font-bold'
              : 'hover:bg-indigo-100 text-gray-800'
          }`;
          wordSpan.textContent = word.isBlanked ? `BLANK${word.suffix}` : word.word;

          const trailing = document.createElement('span');
          trailing.className = 'text-gray-400';
          trailing.textContent = word.trailingPunct;

          wrapper.appendChild(leading);
          wrapper.appendChild(wordSpan);
          wrapper.appendChild(trailing);

          if (word.isBlanked) {
            const tooltip = document.createElement('span');
            tooltip.className = 'word-tooltip absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-sm px-2 py-1 rounded whitespace-nowrap z-10 pointer-events-none';
            tooltip.textContent = word.word;
            wrapper.appendChild(tooltip);
          }

          container.appendChild(wrapper);
        } else {
          const span = document.createElement('span');
          span.className = 'text-gray-400';
          span.textContent = word.original;
          container.appendChild(span);
        }
      });
    }

    function toggleBlank(id) {
      words = words.map(word =>
        word.id === id && word.isWord
          ? { ...word, isBlanked: !word.isBlanked }
          : word
      );
      renderWords();
      updateResults();
    }

    function resetAll() {
      words = words.map(word => ({ ...word, isBlanked: false }));
      renderWords();
      updateResults();
    }

    function blankAll() {
      words = words.map(word =>
        word.isWord ? { ...word, isBlanked: true } : word
      );
      renderWords();
      updateResults();
    }

    function startOver() {
      words = [];
      document.getElementById('inputText').value = '';
      document.getElementById('inputSection').classList.remove('hidden');
      document.getElementById('editorSection').classList.add('hidden');
    }

    function updateResults() {
      const originalText = words.map(w => w.original).join('');
      const blankedText = words.map(w => {
        if (!w.isWord || !w.isBlanked) return w.original;
        return `${w.leadingPunct}BLANK${w.suffix}${w.trailingPunct}`;
      }).join('');

      document.getElementById('originalText').textContent = originalText;
      document.getElementById('promptText').textContent = `In this passage, content words have been replaced with the word BLANK. Translate the passage as best as you can into standard English. The final response should have all English words and retain consistency with the original text.\n\n${blankedText}`;
    }
  </script>
</body>
</html>
